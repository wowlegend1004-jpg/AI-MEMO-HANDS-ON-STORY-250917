# Story 1.4: 신규 사용자 온보딩 플로우

## Status

Skipped - 현재 온보딩은 단순한 형태로 유지

## Story

**As a** 신규 가입 사용자,
**I want** 단계별 온보딩 가이드를 통해 AI 메모장의 주요 기능을 학습하고 설정할 수 있는 기능,
**so that** 서비스를 효과적으로 활용하고 첫 메모 작성까지 자연스럽게 이어질 수 있다.

## Acceptance Criteria

1. 이메일 인증 완료 후 온보딩 페이지가 자동으로 표시되어야 한다
2. 온보딩은 3단계로 구성되어야 한다: 환영 → 기능 소개 → 프로필 설정
3. 각 단계마다 진행 상황 표시기(Progress indicator)가 제공되어야 한다
4. 사용자는 언제든지 온보딩을 건너뛸 수 있어야 한다
5. 프로필 설정에서는 닉네임과 프로필 이미지(선택사항)를 설정할 수 있어야 한다
6. 온보딩 완료 후 첫 메모 작성을 유도하는 빈 대시보드가 표시되어야 한다
7. 온보딩 중 뒤로가기/새로고침 시에도 진행 상태가 유지되어야 한다
8. 모든 단계에서 사용자 경험이 직관적이고 매끄러워야 한다

## Tasks / Subtasks

-   [ ] 온보딩 플로우 설계 및 구현 (AC: 1, 2, 3, 4)
    -   [ ] 다단계 온보딩 컴포넌트 구조 설계
    -   [ ] 진행 상황 표시기 UI 구현
    -   [ ] 단계별 네비게이션 로직 구현
    -   [ ] 건너뛰기 기능 및 라우팅 처리
-   [ ] 환영 단계 구현 (AC: 1, 8)
    -   [ ] 환영 메시지 및 브랜드 소개 UI
    -   [ ] 애니메이션 효과 적용
    -   [ ] 다음 단계로 진행 버튼
-   [ ] 기능 소개 단계 구현 (AC: 8)
    -   [ ] AI 메모장 핵심 기능 소개 카드
    -   [ ] 인터랙티브 기능 미리보기
    -   [ ] 각 기능별 아이콘 및 설명
-   [ ] 프로필 설정 단계 구현 (AC: 5, 8)
    -   [ ] 닉네임 입력 폼 및 검증
    -   [ ] 프로필 이미지 업로드 기능 (선택사항)
    -   [ ] Supabase 사용자 프로필 업데이트
    -   [ ] 설정 완료 피드백
-   [ ] 온보딩 상태 관리 구현 (AC: 7)
    -   [ ] 로컬 스토리지를 활용한 진행 상태 저장
    -   [ ] 새로고침/뒤로가기 시 상태 복원
    -   [ ] 온보딩 완료 상태 Supabase에 저장
-   [ ] 대시보드 연결 및 첫 메모 유도 (AC: 6)
    -   [ ] 온보딩 완료 후 대시보드로 리다이렉트
    -   [ ] 빈 상태 대시보드 UI 개선
    -   [ ] 첫 메모 작성 CTA(Call To Action) 추가

## Dev Notes

### 이전 스토리 인사이트

[Source: Story 1.1, 1.2, 1.3 Dev Agent Records]

-   ✅ Supabase Auth 인프라 완전 구축 완료
-   ✅ 서버 액션 패턴 (`lib/auth/actions.ts`) 확립
-   ✅ shadcn/ui 컴포넌트 시스템 활용 경험
-   ✅ 클라이언트/서버 사이드 렌더링 패턴 정리
-   ✅ 에러 핸들링 및 사용자 피드백 패턴 확립

### 기술 스택 정보

[Source: docs/architecture.md#1-기술-스택]

-   **프레임워크:** Next.js (App Router, Server Actions)
-   **UI:** shadcn/ui + Tailwind + Radix UI
-   **DB/인증:** Supabase (Postgres, Auth, Storage)

### 보안 요구사항

[Source: docs/architecture.md#3-보안]

-   Supabase 서비스 롤 키는 서버 전용으로 사용
-   사용자 ID 스코프로 권한 제어

### 프로젝트 구조

**온보딩 플로우**:

-   온보딩 메인 페이지: `app/onboarding/page.tsx` (기존 개선)
-   온보딩 컴포넌트: `components/onboarding/`
    -   `welcome-step.tsx` - 환영 단계
    -   `features-step.tsx` - 기능 소개 단계
    -   `profile-step.tsx` - 프로필 설정 단계
    -   `progress-indicator.tsx` - 진행 상황 표시기
    -   `onboarding-layout.tsx` - 공통 레이아웃
-   온보딩 상태 관리: `lib/onboarding/`
    -   `state.ts` - 온보딩 상태 관리
    -   `actions.ts` - 프로필 업데이트 서버 액션

### Supabase 구성

**사용자 프로필 테이블**:

```sql
CREATE TABLE public.user_profiles (
  id UUID REFERENCES auth.users(id) PRIMARY KEY,
  nickname TEXT,
  avatar_url TEXT,
  onboarding_completed BOOLEAN DEFAULT FALSE,
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- RLS 정책
ALTER TABLE public.user_profiles ENABLE ROW LEVEL SECURITY;

CREATE POLICY "Users can view own profile" ON public.user_profiles
  FOR SELECT USING (auth.uid() = id);

CREATE POLICY "Users can update own profile" ON public.user_profiles
  FOR UPDATE USING (auth.uid() = id);

CREATE POLICY "Users can insert own profile" ON public.user_profiles
  FOR INSERT WITH CHECK (auth.uid() = id);
```

### 환경 변수 요구사항

[Source: Story 1.1, 1.2, 1.3 - 이미 설정 완료]

-   ✅ `NEXT_PUBLIC_SUPABASE_URL`
-   ✅ `NEXT_PUBLIC_SUPABASE_ANON_KEY`
-   ✅ `SUPABASE_SERVICE_ROLE_KEY`
-   ✅ `NEXT_PUBLIC_SITE_URL`

### 재사용 가능한 컴포넌트

-   `components/ui/button.tsx` - 네비게이션 버튼
-   `components/ui/input.tsx` - 닉네임 입력
-   `components/ui/label.tsx` - 폼 레이블
-   `components/ui/card.tsx` - 단계별 카드 컨테이너
-   `components/ui/progress.tsx` - 진행 상황 표시 (새로 추가 필요)
-   `components/ui/avatar.tsx` - 프로필 이미지 (새로 추가 필요)

### UX/UI 고려사항

-   **모바일 반응형**: 모든 온보딩 단계가 모바일에서 적절히 표시
-   **접근성**: 키보드 네비게이션 및 스크린 리더 지원
-   **성능**: 이미지 업로드 진행 상황 표시 및 최적화
-   **다국어**: 추후 i18n 확장 고려한 텍스트 구조

### Testing

#### 테스트 표준

[Source: docs/architecture.md#6-배포운영]

-   테스트 프레임워크: Jest + React Testing Library (추정)
-   테스트 파일 위치: `__tests__/` 또는 컴포넌트 옆에 `.test.tsx`
-   단위 테스트와 통합 테스트 모두 구현

#### 온보딩 플로우 테스트

-   각 단계별 렌더링 테스트
-   네비게이션 플로우 테스트
-   프로필 저장 로직 테스트
-   건너뛰기 기능 테스트
-   상태 복원 테스트

## Change Log

| Date       | Version | Description      | Author           |
| ---------- | ------- | ---------------- | ---------------- |
| 2025-09-13 | 1.0     | 스토리 생성      | Scrum Master Bob |
| 2025-09-13 | 1.1     | 스토리 SKIP 결정 | Scrum Master Bob |

## Dev Agent Record

이 섹션은 개발 에이전트가 구현 중에 채워집니다.

### Agent Model Used

TBD

### Debug Log References

TBD

### Completion Notes List

TBD

### File List

TBD

## QA Results

QA 에이전트가 완료된 스토리 구현을 검토한 결과입니다.
